# Инструкция по локальному запуску приложения

## Предварительные требования

1. **Python 3.8+** (для бэкенда)
2. **Node.js 18+** (для фронтенда)
3. **PostgreSQL** (база данных) или настройка DATABASE_URL

## Шаг 1: Настройка бэкенда

### 1.1. Установка зависимостей

```bash
# Из корневой директории проекта
pip install -r requirements.txt
```

### 1.2. Настройка переменных окружения

Создайте файл `.env` в корне проекта (или в папке `backend/`) со следующим содержимым:

```env
DATABASE_URL=postgresql://user:password@localhost:5432/padel_db
```

**Примечание:** Замените `user`, `password` и `padel_db` на ваши реальные данные PostgreSQL.

### 1.3. Запуск бэкенда

```bash
# Из корневой директории проекта
cd backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

Или из корневой директории:

```bash
uvicorn backend.main:app --reload --host 0.0.0.0 --port 8000
```

Бэкенд будет доступен по адресу: **http://localhost:8000**

Документация API (Swagger): **http://localhost:8000/docs**

## Шаг 2: Настройка фронтенда

### 2.1. Установка зависимостей

```bash
cd web
npm install
```

### 2.2. Настройка переменных окружения

**Для локальной разработки** создайте файл `web/.env.local`:

```env
VITE_API_URL=http://localhost:8000
```

**Примечание:** Если файл не создан, приложение автоматически использует `http://localhost:8000` в режиме разработки.

Подробнее о настройке окружений см. `web/ENV_SETUP.md`

### 2.3. Запуск фронтенда

```bash
cd web
npm run dev
```

Фронтенд будет доступен по адресу: **http://localhost:5173**

## Шаг 3: Проверка работы

1. Откройте браузер и перейдите на **http://localhost:5173**
2. Убедитесь, что бэкенд запущен на **http://localhost:8000**
3. Проверьте, что в консоли браузера нет ошибок подключения к API

## Возможные проблемы

### Ошибка подключения к базе данных

Убедитесь, что:
- PostgreSQL запущен
- DATABASE_URL указан правильно
- База данных существует

### CORS ошибки

Бэкенд уже настроен на разрешение запросов с `http://localhost:5173`. Если возникают проблемы, проверьте настройки CORS в `backend/main.py`.

### Порт занят

Если порт 8000 или 5173 занят:
- Для бэкенда: измените порт в команде uvicorn (например, `--port 8001`)
- Для фронтенда: измените порт в `vite.config.ts` или используйте переменную окружения `PORT`

## Структура проекта

```
Padel_app/
├── backend/          # FastAPI бэкенд
│   ├── main.py       # Основной файл приложения
│   ├── models.py     # Модели базы данных
│   └── db.py         # Настройка подключения к БД
├── web/              # React + Vite фронтенд
│   ├── src/
│   │   └── App.tsx   # Главный компонент
│   └── .env          # Переменные окружения
└── requirements.txt  # Python зависимости
```

## Полезные команды

### Бэкенд
- `uvicorn backend.main:app --reload` - запуск с автоперезагрузкой
- `uvicorn backend.main:app --reload --port 8001` - запуск на другом порту

### Фронтенд
- `npm run dev` - запуск dev сервера (локальный API)
- `npm run build` - сборка для продакшна
- `npm run build:prod` - сборка для продакшна с явным указанием режима
- `npm run preview` - предпросмотр собранного приложения

## Переключение между локальной и продакшн средой

### Локальная разработка
1. Создайте `web/.env.local` с `VITE_API_URL=http://localhost:8000`
2. Запустите `npm run dev`

### Продакшн деплой
1. Создайте `web/.env.production` с `VITE_API_URL=https://your-api.com`
2. Или установите переменную `VITE_API_URL` на сервере деплоя (Netlify, Vercel и т.д.)
3. Запустите `npm run build:prod`

**Автоматический fallback:** Если переменная не задана, приложение автоматически выберет правильный URL:
- В dev режиме → `http://localhost:8000`
- В prod режиме → `https://padel-app-go6s.onrender.com`

Подробнее см. `web/ENV_SETUP.md`

