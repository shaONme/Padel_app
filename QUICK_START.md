# Быстрый старт для деплоя

## ⚠️ ВАЖНО: Таблицы создаются автоматически!

**Вам НЕ нужно создавать таблицы вручную в PostgreSQL!**

Все таблицы создаются автоматически через Alembic миграции при первом запуске backend.

## Что нужно сделать при деплое:

### 1. Backend (FastAPI)

```bash
# 1. Установить зависимости
pip install -r requirements.txt

# 2. Применить миграции (создаст все таблицы автоматически)
alembic upgrade head

# 3. Запустить сервер
uvicorn backend.main:app --host 0.0.0.0 --port 8000
```

**Миграция создаст:**
- ✅ `tg_chats` - таблица Telegram групп
- ✅ `chat_admins` - связь групп и админов
- ✅ `chat_members` - связь групп и участников
- ✅ Добавит `chat_id` в `tournaments` и `player_mode_stats`

### 2. Bot (Docker)

```bash
cd bot
docker-compose up -d --build
```

**Убедитесь, что в `.env` есть:**
- `BOT_TOKEN` - токен бота от @BotFather
- `BACKEND_URL` - URL вашего backend API
- `WEBAPP_URL` - URL вашего веб-приложения

### 3. Frontend

```bash
cd web
npm install
npm run build
```

## Проверка работы:

1. **Добавьте бота в Telegram группу** - он автоматически зарегистрирует группу
2. **Выполните `/sync` в группе** - синхронизирует участников
3. **Откройте веб-приложение** - выберите группу и создайте турнир

## Если что-то не работает:

1. Проверьте логи backend: `uvicorn` должен показать, что сервер запущен
2. Проверьте логи бота: `docker logs padel_bot`
3. Проверьте, что миграции применены: `alembic current`
4. Проверьте подключение к БД: переменная `DATABASE_URL` должна быть правильной

## Структура таблиц (для справки):

```
players (уже существует)
tournaments (уже существует, добавлен chat_id)
player_mode_stats (уже существует, добавлен chat_id)

tg_chats (создаётся миграцией)
chat_admins (создаётся миграцией)
chat_members (создаётся миграцией)
```

